Using config: configs/x16_base_config.json
Running GEMV tests...
Testing M=1, K=2048, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: RBA  K: CDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:2048, N:2048
Maximum Array Tile Size: {'M': 1, 'K': 32, 'N': 4}
get_arr_tile_stats: arr_latency=2.0496e-06, capacity_utilization=0.00048828125
get_tile_stats: K_reduction_latency: 1e-08 = 131072 / 13107200000000.0
 CDS ['R', 'B', 'A'] {'C': 1, 'R': 1, 'B': 1, 'A': 0.25, 'S': 1, 'D': 1}
2048 = 1 * 2048 * 1
get_tile_io_latency: data_volume=4194304.0, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 0.25, 'S': 1, 'D': 1}
get_tile_io_latency: latency=3.2e-07 = 4194304.0 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 2048, 'N': 2048}, arr_tile_size: {'M': 1, 'K': 32, 'N': 1}, MK_dup: 1, KN_dup:1, MN_dup:32, M_K_io_latency: 3.2e-07, K_N_io_latency: 0, M_N_io_latency: 5e-09, tile_compute_latency:2.0595999999999997e-06 = 2.0496e-06(arr_latency) + 1e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: RBA  K: CDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 2048        | 2048        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 1           | 32          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.00048828125 | 0.03125     | 0.25        | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 2.3895999999999995e-06 cycles|
| Total Compute Latency | 2.0595999999999997e-06 cycles|
| Total Array Latency  | 2.0496e-06             cycles|
| Total Reduction Latency| 1e-08                  cycles|
| IO Latency           | 3.3e-07                cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': True, 'B': True, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': True, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 0.25, 'S': 1, 'D': 1}
Column utilization: 0.03125
Capacity utilization: 0.00048828125
GEMM 1x2048x2048 latency: 2.3895999999999995e-06s
simulated latency: GEMM_1x2048x2048 2.3895999999999995e-06
roofline_model_simdram: total_ops=8388608, total_data_movement=4096, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=1.5249999999999998e-09, memory_bound_time=3.125e-10
GEMM roofline latency: 1.5249999999999998e-09ms
Results written to test_gemm_x16_base_config.json_1_2048_2048_simdram_ddr5_operandocality.csv
Testing M=1, K=8192, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRA  K: BDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:8192, N:2048
Maximum Array Tile Size: {'M': 1, 'K': 64, 'N': 8}
get_arr_tile_stats: arr_latency=2.0496e-06, capacity_utilization=0.00048828125
get_tile_stats: K_reduction_latency: 2e-08 = 262144 / 13107200000000.0
 BDS ['C', 'R', 'A'] {'C': 1, 'R': 1, 'B': 1, 'A': 0.5, 'S': 1, 'D': 1}
8192 = 1 * 8192 * 1
get_tile_io_latency: data_volume=16777216.0, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 0.5, 'S': 1, 'D': 1}
get_tile_io_latency: latency=1.28e-06 = 16777216.0 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 8192, 'N': 2048}, arr_tile_size: {'M': 1, 'K': 64, 'N': 1}, MK_dup: 1, KN_dup:1, MN_dup:64, M_K_io_latency: 1.28e-06, K_N_io_latency: 0, M_N_io_latency: 1e-08, tile_compute_latency:2.0695999999999996e-06 = 2.0496e-06(arr_latency) + 2e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRA  K: BDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 2048        | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 1           | 64          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.00048828125 | 0.0625      | 0.5         | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 3.3695999999999995e-06 cycles|
| Total Compute Latency | 2.0695999999999996e-06 cycles|
| Total Array Latency  | 2.0496e-06             cycles|
| Total Reduction Latency| 2e-08                  cycles|
| IO Latency           | 1.2999999999999998e-06 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': True, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': True, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 0.5, 'S': 1, 'D': 1}
Column utilization: 0.0625
Capacity utilization: 0.00048828125
GEMM 1x8192x2048 latency: 3.3695999999999995e-06s
simulated latency: GEMM_1x8192x2048 3.3695999999999995e-06
roofline_model_simdram: total_ops=33554432, total_data_movement=10240, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=6.099999999999999e-09, memory_bound_time=7.8125e-10
GEMM roofline latency: 6.099999999999999e-09ms
Results written to test_gemm_x16_base_config.json_1_8192_2048_simdram_ddr5_operandocality.csv
Testing M=1, K=32768, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CBD  K: RAS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:32768, N:2048
Maximum Array Tile Size: {'M': 1, 'K': 64, 'N': 2}
get_arr_tile_stats: arr_latency=3.7088e-06, capacity_utilization=0.0009765625
get_tile_stats: K_reduction_latency: 8e-08 = 1048576 / 13107200000000.0
 RAS ['C', 'B', 'D'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
32768 = 1 * 32768 * 1
get_tile_io_latency: data_volume=33554432, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.56e-06 = 33554432 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 32768, 'N': 2048}, arr_tile_size: {'M': 1, 'K': 64, 'N': 2}, MK_dup: 1, KN_dup:1, MN_dup:64, M_K_io_latency: 2.56e-06, K_N_io_latency: 0, M_N_io_latency: 1e-08, tile_compute_latency:3.7888e-06 = 3.7088e-06(arr_latency) + 8e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CBD  K: RAS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 2048        | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 2           | 64          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.0009765625 | 0.0625      | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 6.3688e-06             cycles|
| Total Compute Latency | 3.7888e-06             cycles|
| Total Array Latency  | 3.7088e-06             cycles|
| Total Reduction Latency| 8e-08                  cycles|
| IO Latency           | 2.58e-06               cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': False, 'B': True, 'A': False, 'S': False, 'D': True}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': True, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.0625
Capacity utilization: 0.0009765625
GEMM 1x32768x2048 latency: 6.3688e-06s
simulated latency: GEMM_1x32768x2048 6.3688e-06
roofline_model_simdram: total_ops=134217728, total_data_movement=34816, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=2.4399999999999997e-08, memory_bound_time=2.65625e-09
GEMM roofline latency: 2.4399999999999997e-08ms
Results written to test_gemm_x16_base_config.json_1_32768_2048_simdram_ddr5_operandocality.csv
Testing M=1, K=2048, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: RBA  K: CDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:2048, N:8192
Maximum Array Tile Size: {'M': 1, 'K': 32, 'N': 1}
get_arr_tile_stats: arr_latency=2.0496e-06, capacity_utilization=0.00048828125
get_tile_stats: K_reduction_latency: 4e-08 = 524288 / 13107200000000.0
 CDS ['R', 'B', 'A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
2048 = 1 * 2048 * 1
get_tile_io_latency: data_volume=16777216, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=1.28e-06 = 16777216 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 2048, 'N': 8192}, arr_tile_size: {'M': 1, 'K': 32, 'N': 1}, MK_dup: 1, KN_dup:1, MN_dup:32, M_K_io_latency: 1.28e-06, K_N_io_latency: 0, M_N_io_latency: 2e-08, tile_compute_latency:2.0896e-06 = 2.0496e-06(arr_latency) + 4e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: RBA  K: CDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 8192        | 2048        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 1           | 32          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.00048828125 | 0.03125     | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 3.4095999999999995e-06 cycles|
| Total Compute Latency | 2.0896e-06             cycles|
| Total Array Latency  | 2.0496e-06             cycles|
| Total Reduction Latency| 4e-08                  cycles|
| IO Latency           | 1.32e-06               cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': True, 'B': True, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': True, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.03125
Capacity utilization: 0.00048828125
GEMM 1x2048x8192 latency: 3.4095999999999995e-06s
simulated latency: GEMM_1x2048x8192 3.4095999999999995e-06
roofline_model_simdram: total_ops=33554432, total_data_movement=10240, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=6.099999999999999e-09, memory_bound_time=7.8125e-10
GEMM roofline latency: 6.099999999999999e-09ms
Results written to test_gemm_x16_base_config.json_1_2048_8192_simdram_ddr5_operandocality.csv
Testing M=1, K=8192, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRB  K: ADS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:8192, N:8192
Maximum Array Tile Size: {'M': 1, 'K': 64, 'N': 2}
get_arr_tile_stats: arr_latency=3.7088e-06, capacity_utilization=0.0009765625
get_tile_stats: K_reduction_latency: 8e-08 = 1048576 / 13107200000000.0
 ADS ['C', 'R', 'B'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
8192 = 1 * 8192 * 1
get_tile_io_latency: data_volume=33554432, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.56e-06 = 33554432 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 8192, 'N': 8192}, arr_tile_size: {'M': 1, 'K': 64, 'N': 2}, MK_dup: 1, KN_dup:1, MN_dup:64, M_K_io_latency: 2.56e-06, K_N_io_latency: 0, M_N_io_latency: 4e-08, tile_compute_latency:3.7888e-06 = 3.7088e-06(arr_latency) + 8e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRB  K: ADS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 8192        | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 2           | 64          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.0009765625 | 0.0625      | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 6.4288e-06             cycles|
| Total Compute Latency | 3.7888e-06             cycles|
| Total Array Latency  | 3.7088e-06             cycles|
| Total Reduction Latency| 8e-08                  cycles|
| IO Latency           | 2.64e-06               cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': True, 'B': True, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.0625
Capacity utilization: 0.0009765625
GEMM 1x8192x8192 latency: 6.4288e-06s
simulated latency: GEMM_1x8192x8192 6.4288e-06
roofline_model_simdram: total_ops=134217728, total_data_movement=16384, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=2.4399999999999997e-08, memory_bound_time=1.25e-09
GEMM roofline latency: 2.4399999999999997e-08ms
Results written to test_gemm_x16_base_config.json_1_8192_8192_simdram_ddr5_operandocality.csv
Testing M=1, K=32768, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRD  K: BAS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:32768, N:8192
Maximum Array Tile Size: {'M': 1, 'K': 128, 'N': 4}
get_arr_tile_stats: arr_latency=7.027199999999999e-06, capacity_utilization=0.001953125
get_tile_stats: K_reduction_latency: 1.6e-07 = 2097152 / 13107200000000.0
 BAS ['C', 'R', 'D'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
32768 = 1 * 32768 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 32768, 'N': 8192}, arr_tile_size: {'M': 1, 'K': 128, 'N': 4}, MK_dup: 1, KN_dup:1, MN_dup:128, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 8e-08, tile_compute_latency:7.1871999999999996e-06 = 7.027199999999999e-06(arr_latency) + 1.6e-07(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRD  K: BAS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 8192        | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 4           | 128         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.001953125 | 0.125       | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 1.24672e-05            cycles|
| Total Compute Latency | 7.1871999999999996e-06 cycles|
| Total Array Latency  | 7.027199999999999e-06  cycles|
| Total Reduction Latency| 1.6e-07                cycles|
| IO Latency           | 5.28e-06               cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': True, 'B': False, 'A': False, 'S': False, 'D': True}|
| reduction            | {'C': False, 'R': False, 'B': True, 'A': True, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.125
Capacity utilization: 0.001953125
GEMM 1x32768x8192 latency: 1.24672e-05s
simulated latency: GEMM_1x32768x8192 1.24672e-05
roofline_model_simdram: total_ops=536870912, total_data_movement=40960, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=9.759999999999999e-08, memory_bound_time=3.125e-09
GEMM roofline latency: 9.759999999999999e-08ms
Results written to test_gemm_x16_base_config.json_1_32768_8192_simdram_ddr5_operandocality.csv
Testing M=1, K=2048, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CBAD  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:2048, N:32768
Maximum Array Tile Size: {'M': 1, 'K': 64, 'N': 2}
get_arr_tile_stats: arr_latency=3.7088e-06, capacity_utilization=0.0009765625
get_tile_stats: K_reduction_latency: 8e-08 = 1048576 / 13107200000000.0
 RS ['C', 'B', 'A', 'D'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
2048 = 1 * 2048 * 1
get_tile_io_latency: data_volume=33554432, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.56e-06 = 33554432 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 2048, 'N': 32768}, arr_tile_size: {'M': 1, 'K': 64, 'N': 2}, MK_dup: 1, KN_dup:1, MN_dup:64, M_K_io_latency: 2.56e-06, K_N_io_latency: 0, M_N_io_latency: 1.6e-07, tile_compute_latency:3.7888e-06 = 3.7088e-06(arr_latency) + 8e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CBAD  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 32768       | 2048        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 2           | 64          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.0009765625 | 0.0625      | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 6.6688e-06             cycles|
| Total Compute Latency | 3.7888e-06             cycles|
| Total Array Latency  | 3.7088e-06             cycles|
| Total Reduction Latency| 8e-08                  cycles|
| IO Latency           | 2.8800000000000004e-06 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': False, 'B': True, 'A': True, 'S': False, 'D': True}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.0625
Capacity utilization: 0.0009765625
GEMM 1x2048x32768 latency: 6.6688e-06s
simulated latency: GEMM_1x2048x32768 6.6688e-06
roofline_model_simdram: total_ops=134217728, total_data_movement=34816, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=2.4399999999999997e-08, memory_bound_time=2.65625e-09
GEMM roofline latency: 2.4399999999999997e-08ms
Results written to test_gemm_x16_base_config.json_1_2048_32768_simdram_ddr5_operandocality.csv
Testing M=1, K=8192, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: RBA  K: CDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:8192, N:32768
Maximum Array Tile Size: {'M': 1, 'K': 128, 'N': 4}
get_arr_tile_stats: arr_latency=7.027199999999999e-06, capacity_utilization=0.001953125
get_tile_stats: K_reduction_latency: 1.6e-07 = 2097152 / 13107200000000.0
 CDS ['R', 'B', 'A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
8192 = 1 * 8192 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 8192, 'N': 32768}, arr_tile_size: {'M': 1, 'K': 128, 'N': 4}, MK_dup: 1, KN_dup:1, MN_dup:128, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 3.2e-07, tile_compute_latency:7.1871999999999996e-06 = 7.027199999999999e-06(arr_latency) + 1.6e-07(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: RBA  K: CDS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 32768       | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 4           | 128         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.001953125 | 0.125       | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 1.29472e-05            cycles|
| Total Compute Latency | 7.1871999999999996e-06 cycles|
| Total Array Latency  | 7.027199999999999e-06  cycles|
| Total Reduction Latency| 1.6e-07                cycles|
| IO Latency           | 5.760000000000001e-06  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': True, 'B': True, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': True, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.125
Capacity utilization: 0.001953125
GEMM 1x8192x32768 latency: 1.29472e-05s
simulated latency: GEMM_1x8192x32768 1.29472e-05
roofline_model_simdram: total_ops=536870912, total_data_movement=40960, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=9.759999999999999e-08, memory_bound_time=3.125e-09
GEMM roofline latency: 9.759999999999999e-08ms
Results written to test_gemm_x16_base_config.json_1_8192_32768_simdram_ddr5_operandocality.csv
Testing M=1, K=32768, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRB  K: ADS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:1, K:32768, N:32768
Maximum Array Tile Size: {'M': 1, 'K': 256, 'N': 8}
get_arr_tile_stats: arr_latency=1.3664e-05, capacity_utilization=0.00390625
get_tile_stats: K_reduction_latency: 3.2e-07 = 4194304 / 13107200000000.0
 ADS ['C', 'R', 'B'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
32768 = 1 * 32768 * 1
get_tile_io_latency: data_volume=134217728, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=1.024e-05 = 134217728 / 13107200000000.0
get_tile_stats: tile_size: {'M': 1, 'K': 32768, 'N': 32768}, arr_tile_size: {'M': 1, 'K': 256, 'N': 8}, MK_dup: 1, KN_dup:1, MN_dup:256, M_K_io_latency: 1.024e-05, K_N_io_latency: 0, M_N_io_latency: 6.4e-07, tile_compute_latency:1.3984e-05 = 1.3664e-05(arr_latency) + 3.2e-07(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M:   N: CRB  K: ADS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 1           | 32768       | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 8           | 256         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.00390625  | 0.25        | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 2.5504000000000002e-05 cycles|
| Total Compute Latency | 1.3984e-05             cycles|
| Total Array Latency  | 1.3664e-05             cycles|
| Total Reduction Latency| 3.2e-07                cycles|
| IO Latency           | 1.1520000000000002e-05 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': True, 'B': True, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 0.25
Capacity utilization: 0.00390625
GEMM 1x32768x32768 latency: 2.5504000000000002e-05s
simulated latency: GEMM_1x32768x32768 2.5504000000000002e-05
roofline_model_simdram: total_ops=2147483648, total_data_movement=65536, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=3.9039999999999995e-07, memory_bound_time=5e-09
GEMM roofline latency: 3.9039999999999995e-07ms
Results written to test_gemm_x16_base_config.json_1_32768_32768_simdram_ddr5_operandocality.csv
/Users/max/Desktop/LLMCompass/exp_scripts/sensitivity/gemv_size
