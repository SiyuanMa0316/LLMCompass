Using config: configs/x16_base_config.json
Running GEMM tests...
Testing M=2048, K=2048, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CR  N: B  K: ADS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:2048, K:2048, N:2048
Maximum Array Tile Size: {'M': 8, 'K': 32, 'N': 128}
get_arr_tile_stats: arr_latency=0.00013952, capacity_utilization=0.015625
get_tile_stats: K_reduction_latency: 2.048e-05 = 268435456 / 13107200000000.0
CR ADS ['B'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
4194304 = 2048 * 2048 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 2048, 'K': 2048, 'N': 2048}, arr_tile_size: {'M': 8, 'K': 32, 'N': 128}, MK_dup: 1, KN_dup:8, MN_dup:32, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 1.024e-05, tile_compute_latency:0.00015999999999999999 = 0.00013952(arr_latency) + 2.048e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CR  N: B  K: ADS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 2048        | 2048        | 2048        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 8           | 128         | 32          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.015625    | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.0001856              cycles|
| Total Compute Latency | 0.00015999999999999999 cycles|
| Total Array Latency  | 0.00013952             cycles|
| Total Reduction Latency| 2.048e-05              cycles|
| IO Latency           | 2.5600000000000002e-05 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': True, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.015625
GEMM 2048x2048x2048 latency: 0.0001856s
simulated latency: GEMM_2048x2048x2048 0.0001856
roofline_model_simdram: total_ops=17179869184, total_data_movement=8388608, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=2.4985599999999997e-05, memory_bound_time=6.4e-07
GEMM roofline latency: 2.4985599999999997e-05ms
Results written to test_gemm_x16_base_config.json_2048_2048_2048_simdram_ddr5_operandocality.csv
Testing M=2048, K=8192, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: RB  N: C  K: ADS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:2048, K:8192, N:2048
Maximum Array Tile Size: {'M': 4, 'K': 128, 'N': 256}
get_arr_tile_stats: arr_latency=0.000278784, capacity_utilization=0.03125
get_tile_stats: K_reduction_latency: 2.048e-05 = 268435456 / 13107200000000.0
RB ADS ['C'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
8388608 = 2048 * 4096 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 2048, 'K': 4096, 'N': 2048}, arr_tile_size: {'M': 4, 'K': 64, 'N': 256}, MK_dup: 1, KN_dup:4, MN_dup:64, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 2.048e-05, tile_compute_latency:0.00029926400000000004 = 0.000278784(arr_latency) + 2.048e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: RB  N: C  K: ADS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 2048        | 2048        | 4096        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 4           | 256         | 64          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.03125     | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.0006497280000000001  cycles|
| Total Compute Latency | 0.0005985280000000001  cycles|
| Total Array Latency  | 0.000557568            cycles|
| Total Reduction Latency| 4.096e-05              cycles|
| IO Latency           | 5.12e-05               cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 2                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.03125
GEMM 2048x8192x2048 latency: 0.0006497280000000001s
simulated latency: GEMM_2048x8192x2048 0.0006497280000000001
roofline_model_simdram: total_ops=68719476736, total_data_movement=20971520, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=9.994239999999999e-05, memory_bound_time=1.6e-06
GEMM roofline latency: 9.994239999999999e-05ms
Results written to test_gemm_x16_base_config.json_2048_8192_2048_simdram_ddr5_operandocality.csv
Testing M=2048, K=32768, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CBA  N:   K: RDS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:2048, K:32768, N:2048
Maximum Array Tile Size: {'M': 2, 'K': 128, 'N': 2048}
get_arr_tile_stats: arr_latency=0.00222848, capacity_utilization=0.25
get_tile_stats: K_reduction_latency: 8.192e-05 = 1073741824 / 13107200000000.0
CBA RDS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
67108864 = 2048 * 32768 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 2048, 'K': 32768, 'N': 2048}, arr_tile_size: {'M': 2, 'K': 128, 'N': 2048}, MK_dup: 1, KN_dup:2, MN_dup:128, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 4.096e-05, tile_compute_latency:0.0023104 = 0.00222848(arr_latency) + 8.192e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CBA  N:   K: RDS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 2048        | 2048        | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 2           | 2048        | 128         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.25        | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.0023974400000000002  cycles|
| Total Compute Latency | 0.0023104              cycles|
| Total Array Latency  | 0.00222848             cycles|
| Total Reduction Latency| 8.192e-05              cycles|
| IO Latency           | 8.704000000000001e-05  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.25
GEMM 2048x32768x2048 latency: 0.0023974400000000002s
simulated latency: GEMM_2048x32768x2048 0.0023974400000000002
roofline_model_simdram: total_ops=274877906944, total_data_movement=71303168, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.00039976959999999995, memory_bound_time=5.44e-06
GEMM roofline latency: 0.00039976959999999995ms
Results written to test_gemm_x16_base_config.json_2048_32768_2048_simdram_ddr5_operandocality.csv
Testing M=8192, K=2048, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: R  N: CB  K: ADS  Array Mapping:  R: KN  C: M
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:8192, K:2048, N:8192
Maximum Array Tile Size: {'M': 256, 'K': 32, 'N': 64}
get_arr_tile_stats: arr_latency=0.00222848, capacity_utilization=0.125
get_tile_stats: K_reduction_latency: 0.00032768 = 4294967296 / 13107200000000.0
R ADS ['C', 'B'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
16777216 = 8192 * 2048 * 1
get_tile_io_latency: data_volume=2147483648, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=0.00016384 = 2147483648 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 2048, 'N': 8192}, arr_tile_size: {'M': 256, 'K': 32, 'N': 64}, MK_dup: 1, KN_dup:256, MN_dup:1, M_K_io_latency: 0.00016384, K_N_io_latency: 0, M_N_io_latency: 5.12e-06, tile_compute_latency:0.00255616 = 0.00222848(arr_latency) + 0.00032768(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: R  N: CB  K: ADS  Array Mapping:  R: KN  C: M
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 8192        | 8192        | 2048        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 256         | 64          | 32          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.125       | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.00273024             cycles|
| Total Compute Latency | 0.00255616             cycles|
| Total Array Latency  | 0.00222848             cycles|
| Total Reduction Latency| 0.00032768             cycles|
| IO Latency           | 0.00017408000000000001 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': False, 'B': True, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.125
GEMM 8192x2048x8192 latency: 0.00273024s
simulated latency: GEMM_8192x2048x8192 0.00273024
roofline_model_simdram: total_ops=274877906944, total_data_movement=83886080, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.00039976959999999995, memory_bound_time=6.4e-06
GEMM roofline latency: 0.00039976959999999995ms
Results written to test_gemm_x16_base_config.json_8192_2048_8192_simdram_ddr5_operandocality.csv
Testing M=8192, K=8192, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRA  N:   K: BDS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:8192, K:8192, N:8192
Maximum Array Tile Size: {'M': 4, 'K': 64, 'N': 8192}
get_arr_tile_stats: arr_latency=0.008912064, capacity_utilization=0.9998779296875
get_tile_stats: K_reduction_latency: 0.00065528 = 8588886016 / 13107200000000.0
CRA BDS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
67108864 = 8192 * 8192 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 8192, 'N': 8191}, arr_tile_size: {'M': 4, 'K': 64, 'N': 8191}, MK_dup: 1, KN_dup:4, MN_dup:64, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 0.00032764, tile_compute_latency:0.009567344 = 0.008912064(arr_latency) + 0.00065528(K_reduction_latency)
get_arr_tile_stats: arr_latency=1.344e-06, capacity_utilization=0.0001220703125
get_tile_stats: K_reduction_latency: 8e-08 = 1048576 / 13107200000000.0
CRA BDS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
67108864 = 8192 * 8192 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 8192, 'N': 1}, arr_tile_size: {'M': 4, 'K': 64, 'N': 1}, MK_dup: 1, KN_dup:4, MN_dup:64, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 4e-08, tile_compute_latency:1.424e-06 = 1.344e-06(arr_latency) + 8e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRA  N:   K: BDS  Array Mapping:  R: N  C: MK
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 8192        | 8191        | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 4           | 8191        | 64          |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.9998779296875 | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.009901608            cycles|
| Total Compute Latency | 0.009568768            cycles|
| Total Array Latency  | 0.008913408000000001   cycles|
| Total Reduction Latency| 0.0006553599999999999  cycles|
| IO Latency           | 0.00033283999999999994 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': True, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 1                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.9998779296875
GEMM 8192x8192x8192 latency: 0.009901608s
simulated latency: GEMM_8192x8192x8192 0.009901608
roofline_model_simdram: total_ops=1099511627776, total_data_movement=134217728, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.0015990783999999998, memory_bound_time=1.024e-05
GEMM roofline latency: 0.0015990783999999998ms
Results written to test_gemm_x16_base_config.json_8192_8192_8192_simdram_ddr5_operandocality.csv
Testing M=8192, K=32768, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRA  N:   K: BDS  Array Mapping:  R: K  C: MN
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:8192, K:32768, N:8192
Maximum Array Tile Size: {'M': 4, 'K': 256, 'N': 8192}
get_arr_tile_stats: arr_latency=0.000278784, capacity_utilization=0.03125
get_tile_stats: K_reduction_latency: 5.12e-06 = 67108864 / 13107200000000.0
CRA BDS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
268435456 = 8192 * 32768 * 1
get_tile_io_latency: data_volume=268435456, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.048e-05 = 268435456 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 32768, 'N': 64}, arr_tile_size: {'M': 4, 'K': 256, 'N': 64}, MK_dup: 64, KN_dup:4, MN_dup:1, M_K_io_latency: 0.00131072, K_N_io_latency: 0, M_N_io_latency: 4e-08, tile_compute_latency:0.000283904 = 0.000278784(arr_latency) + 5.12e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRA  N:   K: BDS  Array Mapping:  R: K  C: MN
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 8192        | 64          | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 4           | 64          | 256         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.03125     | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.037655592000000085   cycles|
| Total Compute Latency | 0.0363397120000001     cycles|
| Total Array Latency  | 0.03568435200000001    cycles|
| Total Reduction Latency| 0.0006553599999999988  cycles|
| IO Latency           | 0.0013158799999999974  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | True                  |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': True, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 128                    |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.03125
GEMM 8192x32768x8192 latency: 0.037655592000000085s
simulated latency: GEMM_8192x32768x8192 0.037655592000000085
roofline_model_simdram: total_ops=4398046511104, total_data_movement=335544320, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.006396313599999999, memory_bound_time=2.56e-05
GEMM roofline latency: 0.006396313599999999ms
Results written to test_gemm_x16_base_config.json_8192_32768_8192_simdram_ddr5_operandocality.csv
Testing M=32768, K=2048, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRBA  N:   K: DS  Array Mapping:  R: MK  C: N
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:32768, K:2048, N:32768
Maximum Array Tile Size: {'M': 1, 'K': 256, 'N': 32768}
get_arr_tile_stats: arr_latency=0.000278784, capacity_utilization=0.015625
get_tile_stats: K_reduction_latency: 5.12e-06 = 67108864 / 13107200000000.0
CRBA DS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
67108864 = 32768 * 2048 * 1
get_tile_io_latency: data_volume=67108864, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 2048, 'N': 256}, arr_tile_size: {'M': 1, 'K': 256, 'N': 256}, MK_dup: 256, KN_dup:1, MN_dup:1, M_K_io_latency: 0.00131072, K_N_io_latency: 0, M_N_io_latency: 6.4e-07, tile_compute_latency:0.000283904 = 0.000278784(arr_latency) + 5.12e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRBA  N:   K: DS  Array Mapping:  R: MK  C: N
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 32768       | 256         | 2048        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 256         | 256         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.015625    | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.037732992            cycles|
| Total Compute Latency | 0.0363397120000001     cycles|
| Total Array Latency  | 0.03568435200000001    cycles|
| Total Reduction Latency| 0.0006553599999999988  cycles|
| IO Latency           | 0.0013932800000000132  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | True                  |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 128                    |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.015625
GEMM 32768x2048x32768 latency: 0.037732992s
simulated latency: GEMM_32768x2048x32768 0.037732992
roofline_model_simdram: total_ops=4398046511104, total_data_movement=1140850688, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.006396313599999999, memory_bound_time=8.704e-05
GEMM roofline latency: 0.006396313599999999ms
Results written to test_gemm_x16_base_config.json_32768_2048_32768_simdram_ddr5_operandocality.csv
Testing M=32768, K=8192, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRAD  N:   K: BS  Array Mapping:  R: K  C: MN
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:32768, K:8192, N:32768
Maximum Array Tile Size: {'M': 2, 'K': 512, 'N': 32768}
get_arr_tile_stats: arr_latency=0.000557312, capacity_utilization=0.0625
get_tile_stats: K_reduction_latency: 5.12e-06 = 67108864 / 13107200000000.0
CRAD BS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
268435456 = 32768 * 8192 * 1
get_tile_io_latency: data_volume=268435456, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.048e-05 = 268435456 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 8192, 'N': 128}, arr_tile_size: {'M': 2, 'K': 512, 'N': 128}, MK_dup: 128, KN_dup:2, MN_dup:1, M_K_io_latency: 0.00262144, K_N_io_latency: 0, M_N_io_latency: 3.2e-07, tile_compute_latency:0.000562432 = 0.000557312(arr_latency) + 5.12e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CRAD  N:   K: BS  Array Mapping:  R: K  C: MN
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 32768       | 128         | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 2           | 128         | 512         |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.0625      | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.14668627199999992    cycles|
| Total Compute Latency | 0.14398259200000035    cycles|
| Total Array Latency  | 0.14267187200000048    cycles|
| Total Reduction Latency| 0.0013107199999999927  cycles|
| IO Latency           | 0.0027036799999999575  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | True                  |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': True, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 256                    |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.0625
GEMM 32768x8192x32768 latency: 0.14668627199999992s
simulated latency: GEMM_32768x8192x32768 0.14668627199999992
roofline_model_simdram: total_ops=17592186044416, total_data_movement=1342177280, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.025585254399999997, memory_bound_time=0.0001024
GEMM roofline latency: 0.025585254399999997ms
Results written to test_gemm_x16_base_config.json_32768_8192_32768_simdram_ddr5_operandocality.csv
Testing M=32768, K=32768, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram logical config: 8channels x 32ranks x 16banks x 8arrays x 1subarrays x 131072subarr_rows x 256cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 687.5908196721313Tops
memory capacity: 1024.0GB
peripheral area: 830.6070382046778mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CBAD  N:   K: RS  Array Mapping:  R: K  C: MN
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:32768, K:32768, N:32768
Maximum Array Tile Size: {'M': 4, 'K': 1024, 'N': 32768}
get_arr_tile_stats: arr_latency=0.001114368, capacity_utilization=0.125
get_tile_stats: K_reduction_latency: 5.12e-06 = 67108864 / 13107200000000.0
CBAD RS [] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
1073741824 = 32768 * 32768 * 1
get_tile_io_latency: data_volume=1073741824, dup=[], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=8.192e-05 = 1073741824 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 32768, 'N': 64}, arr_tile_size: {'M': 4, 'K': 1024, 'N': 64}, MK_dup: 64, KN_dup:4, MN_dup:1, M_K_io_latency: 0.00524288, K_N_io_latency: 0, M_N_io_latency: 1.6e-07, tile_compute_latency:0.0011194879999999999 = 0.001114368(arr_latency) + 5.12e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: 
  Array Multicast: False
  Column Popcount: False
  Tile Mapping:  M: CBAD  N:   K: RS  Array Mapping:  R: K  C: MN
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 32768       | 64          | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 4           | 64          | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.125       | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.5785028159999923     cycles|
| Total Compute Latency | 0.5731778559999972     cycles|
| Total Array Latency  | 0.570556415999994      cycles|
| Total Reduction Latency| 0.00262143999999998    cycles|
| IO Latency           | 0.005324959999999958   cycles|

----------- Hardware Requirements ---------------
| col_multicast        | True                  |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 512                    |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.125
GEMM 32768x32768x32768 latency: 0.5785028159999923s
simulated latency: GEMM_32768x32768x32768 0.5785028159999923
roofline_model_simdram: total_ops=70368744177664, total_data_movement=2147483648, peak_flops=687590819672131.2, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.10234101759999999, memory_bound_time=0.00016384
GEMM roofline latency: 0.10234101759999999ms
Results written to test_gemm_x16_base_config.json_32768_32768_32768_simdram_ddr5_operandocality.csv
/Users/max/Desktop/LLMCompass/exp_scripts/sensitivity/gemm_size
