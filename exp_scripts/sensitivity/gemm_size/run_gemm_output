Using config: configs/x16_base_config.json
Running GEMM tests...
Testing M=2048, K=2048, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRD  N: BA  K: S  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:2048, K:2048, N:2048
Maximum Array Tile Size: {'M': 1, 'K': 2048, 'N': 8}
get_arr_tile_stats: arr_latency=2.0496e-06, capacity_utilization=0.00390625
get_tile_stats: K_reduction_latency: 3.2e-07 = 4194304 / 13107200000000.0
CRD S ['B', 'A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
2097152 = 2048 * 1024 * 1
get_tile_io_latency: data_volume=2097152, dup=['B', 'A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.56e-06 = 2097152 / 819200000000.0
get_tile_stats: tile_size: {'M': 2048, 'K': 1024, 'N': 2048}, arr_tile_size: {'M': 1, 'K': 1024, 'N': 8}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.56e-06, K_N_io_latency: 0, M_N_io_latency: 3.2e-07, tile_compute_latency:2.3695999999999997e-06 = 2.0496e-06(arr_latency) + 3.2e-07(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRD  N: BA  K: S  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 2048        | 2048        | 1024        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 8           | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.00390625  | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 1.04992e-05            cycles|
| Total Compute Latency | 4.7391999999999995e-06 cycles|
| Total Array Latency  | 4.0992e-06             cycles|
| Total Reduction Latency| 6.4e-07                cycles|
| IO Latency           | 5.760000000000001e-06  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': True, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 2                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.00390625
GEMM 2048x2048x2048 latency: 1.04992e-05s
simulated latency: GEMM_2048x2048x2048 1.04992e-05
roofline_model_simdram: total_ops=17179869184, total_data_movement=8388608, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=3.1231999999999996e-06, memory_bound_time=6.4e-07
GEMM roofline latency: 3.1231999999999996e-06ms
Results written to test_gemm_x16_base_config.json_2048_2048_2048_simdram_ddr5_operandocality.csv
Testing M=2048, K=8192, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: RB  N: CA  K: DS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:2048, K:8192, N:2048
Maximum Array Tile Size: {'M': 4, 'K': 1024, 'N': 16}
get_arr_tile_stats: arr_latency=1.3664e-05, capacity_utilization=0.03125
get_tile_stats: K_reduction_latency: 2.56e-06 = 33554432 / 13107200000000.0
RB DS ['C', 'A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
16777216 = 2048 * 8192 * 1
get_tile_io_latency: data_volume=134217728, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=1.024e-05 = 134217728 / 13107200000000.0
get_tile_stats: tile_size: {'M': 2048, 'K': 8192, 'N': 2048}, arr_tile_size: {'M': 4, 'K': 1024, 'N': 16}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 1.024e-05, K_N_io_latency: 0, M_N_io_latency: 3.2e-07, tile_compute_latency:1.6224e-05 = 1.3664e-05(arr_latency) + 2.56e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: RB  N: CA  K: DS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 2048        | 2048        | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 4           | 16          | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.03125     | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 2.7104e-05             cycles|
| Total Compute Latency | 1.6224e-05             cycles|
| Total Array Latency  | 1.3664e-05             cycles|
| Total Reduction Latency| 2.56e-06               cycles|
| IO Latency           | 1.0880000000000001e-05 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': True, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.03125
GEMM 2048x8192x2048 latency: 2.7104e-05s
simulated latency: GEMM_2048x8192x2048 2.7104e-05
roofline_model_simdram: total_ops=68719476736, total_data_movement=20971520, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=1.2492799999999998e-05, memory_bound_time=1.6e-06
GEMM roofline latency: 1.2492799999999998e-05ms
Results written to test_gemm_x16_base_config.json_2048_8192_2048_simdram_ddr5_operandocality.csv
Testing M=2048, K=32768, N=2048
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CBD  N: A  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:2048, K:32768, N:2048
Maximum Array Tile Size: {'M': 2, 'K': 1024, 'N': 128}
get_arr_tile_stats: arr_latency=5.34848e-05, capacity_utilization=0.125
get_tile_stats: K_reduction_latency: 1.024e-05 = 134217728 / 13107200000000.0
CBD RS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
67108864 = 2048 * 32768 * 1
get_tile_io_latency: data_volume=67108864, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 2048, 'K': 32768, 'N': 2048}, arr_tile_size: {'M': 2, 'K': 1024, 'N': 128}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 3.2e-07, tile_compute_latency:6.37248e-05 = 5.34848e-05(arr_latency) + 1.024e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CBD  N: A  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 2048        | 2048        | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 2           | 128         | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.125       | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 6.94848e-05            cycles|
| Total Compute Latency | 6.37248e-05            cycles|
| Total Array Latency  | 5.34848e-05            cycles|
| Total Reduction Latency| 1.024e-05              cycles|
| IO Latency           | 5.760000000000001e-06  cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.125
GEMM 2048x32768x2048 latency: 6.94848e-05s
simulated latency: GEMM_2048x32768x2048 6.94848e-05
roofline_model_simdram: total_ops=274877906944, total_data_movement=71303168, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=4.9971199999999993e-05, memory_bound_time=5.44e-06
GEMM roofline latency: 4.9971199999999993e-05ms
Results written to test_gemm_x16_base_config.json_2048_32768_2048_simdram_ddr5_operandocality.csv
Testing M=8192, K=2048, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRB  N: AD  K: S  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:8192, K:2048, N:8192
Maximum Array Tile Size: {'M': 2, 'K': 2048, 'N': 64}
get_arr_tile_stats: arr_latency=2.6937599999999998e-05, capacity_utilization=0.0625
get_tile_stats: K_reduction_latency: 5.12e-06 = 67108864 / 13107200000000.0
CRB S ['A', 'D'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
8388608 = 8192 * 1024 * 1
get_tile_io_latency: data_volume=67108864, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 1024, 'N': 8192}, arr_tile_size: {'M': 2, 'K': 1024, 'N': 64}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 5.12e-06, tile_compute_latency:3.2057599999999996e-05 = 2.6937599999999998e-05(arr_latency) + 5.12e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRB  N: AD  K: S  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 8192        | 8192        | 1024        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 2           | 64          | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.0625      | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 8.459519999999999e-05  cycles|
| Total Compute Latency | 6.411519999999999e-05  cycles|
| Total Array Latency  | 5.3875199999999995e-05 cycles|
| Total Reduction Latency| 1.024e-05              cycles|
| IO Latency           | 2.048e-05              cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': True}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 2                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.0625
GEMM 8192x2048x8192 latency: 8.459519999999999e-05s
simulated latency: GEMM_8192x2048x8192 8.459519999999999e-05
roofline_model_simdram: total_ops=274877906944, total_data_movement=83886080, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=4.9971199999999993e-05, memory_bound_time=6.4e-06
GEMM roofline latency: 4.9971199999999993e-05ms
Results written to test_gemm_x16_base_config.json_8192_2048_8192_simdram_ddr5_operandocality.csv
Testing M=8192, K=8192, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRB  N: A  K: DS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:8192, K:8192, N:8192
Maximum Array Tile Size: {'M': 2, 'K': 1024, 'N': 512}
get_arr_tile_stats: arr_latency=0.00021276799999999998, capacity_utilization=0.5
get_tile_stats: K_reduction_latency: 4.096e-05 = 536870912 / 13107200000000.0
CRB DS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
67108864 = 8192 * 8192 * 1
get_tile_io_latency: data_volume=67108864, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=5.12e-06 = 67108864 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 8192, 'N': 8192}, arr_tile_size: {'M': 2, 'K': 1024, 'N': 512}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 5.12e-06, K_N_io_latency: 0, M_N_io_latency: 5.12e-06, tile_compute_latency:0.000253728 = 0.00021276799999999998(arr_latency) + 4.096e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRB  N: A  K: DS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 8192        | 8192        | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 2           | 512         | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.5         | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.000269088            cycles|
| Total Compute Latency | 0.000253728            cycles|
| Total Array Latency  | 0.00021276799999999998 cycles|
| Total Reduction Latency| 4.096e-05              cycles|
| IO Latency           | 1.5360000000000002e-05 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 0                      |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 1                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.5
GEMM 8192x8192x8192 latency: 0.000269088s
simulated latency: GEMM_8192x8192x8192 0.000269088
roofline_model_simdram: total_ops=1099511627776, total_data_movement=134217728, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.00019988479999999997, memory_bound_time=1.024e-05
GEMM roofline latency: 0.00019988479999999997ms
Results written to test_gemm_x16_base_config.json_8192_8192_8192_simdram_ddr5_operandocality.csv
Testing M=8192, K=32768, N=8192
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CBD  N: A  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:8192, K:32768, N:8192
Maximum Array Tile Size: {'M': 8, 'K': 1024, 'N': 512}
get_arr_tile_stats: arr_latency=0.00037536959999999995, capacity_utilization=0.8828125
get_tile_stats: K_reduction_latency: 7.232e-05 = 947912704 / 13107200000000.0
CBD RS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
268435456 = 8192 * 32768 * 1
get_tile_io_latency: data_volume=268435456, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.048e-05 = 268435456 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 32768, 'N': 3616}, arr_tile_size: {'M': 8, 'K': 1024, 'N': 226}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.048e-05, K_N_io_latency: 0, M_N_io_latency: 2.26e-06, tile_compute_latency:0.00044768959999999996 = 0.00037536959999999995(arr_latency) + 7.232e-05(K_reduction_latency)
get_arr_tile_stats: arr_latency=9.994240000000001e-05, capacity_utilization=0.234375
get_tile_stats: K_reduction_latency: 1.92e-05 = 251658240 / 13107200000000.0
CBD RS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
268435456 = 8192 * 32768 * 1
get_tile_io_latency: data_volume=268435456, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.048e-05 = 268435456 / 13107200000000.0
get_tile_stats: tile_size: {'M': 8192, 'K': 32768, 'N': 960}, arr_tile_size: {'M': 8, 'K': 1024, 'N': 60}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.048e-05, K_N_io_latency: 0, M_N_io_latency: 6e-07, tile_compute_latency:0.0001191424 = 9.994240000000001e-05(arr_latency) + 1.92e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CBD  N: A  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 8192        | 3616        | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 8           | 226         | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.8828125   | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.0010407216           cycles|
| Total Compute Latency | 0.0010145216           cycles|
| Total Array Latency  | 0.0008506815999999999  cycles|
| Total Reduction Latency| 0.00016384             cycles|
| IO Latency           | 2.62e-05               cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 960                    |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 2                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.8828125
GEMM 8192x32768x8192 latency: 0.0010407216s
simulated latency: GEMM_8192x32768x8192 0.0010407216
roofline_model_simdram: total_ops=4398046511104, total_data_movement=335544320, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.0007995391999999999, memory_bound_time=2.56e-05
GEMM roofline latency: 0.0007995391999999999ms
Results written to test_gemm_x16_base_config.json_8192_32768_8192_simdram_ddr5_operandocality.csv
Testing M=32768, K=2048, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRBD  N: A  K: S  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:32768, K:2048, N:32768
Maximum Array Tile Size: {'M': 1, 'K': 2048, 'N': 2048}
get_arr_tile_stats: arr_latency=0.00021256059999999997, capacity_utilization=0.49951171875
get_tile_stats: K_reduction_latency: 4.092e-05 = 536346624 / 13107200000000.0
CRBD S ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
33554432 = 32768 * 1024 * 1
get_tile_io_latency: data_volume=33554432, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.56e-06 = 33554432 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 1024, 'N': 16368}, arr_tile_size: {'M': 1, 'K': 1024, 'N': 1023}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.56e-06, K_N_io_latency: 0, M_N_io_latency: 4.092e-05, tile_compute_latency:0.0002534806 = 0.00021256059999999997(arr_latency) + 4.092e-05(K_reduction_latency)
get_arr_tile_stats: arr_latency=8.051999999999999e-07, capacity_utilization=0.0009765625
get_tile_stats: K_reduction_latency: 8e-08 = 1048576 / 13107200000000.0
CRBD S ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
33554432 = 32768 * 1024 * 1
get_tile_io_latency: data_volume=33554432, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.56e-06 = 33554432 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 1024, 'N': 32}, arr_tile_size: {'M': 1, 'K': 1024, 'N': 2}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.56e-06, K_N_io_latency: 0, M_N_io_latency: 8e-08, tile_compute_latency:8.851999999999999e-07 = 8.051999999999999e-07(arr_latency) + 8e-08(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRBD  N: A  K: S  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 32768       | 16368       | 1024        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 1           | 1023        | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.49951171875 | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.0012666528           cycles|
| Total Compute Latency | 0.0010156928           cycles|
| Total Array Latency  | 0.0008518527999999998  cycles|
| Total Reduction Latency| 0.00016384000000000003 cycles|
| IO Latency           | 0.00025096000000000005 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 32                     |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 2                      |
| K_t                   | 2                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.49951171875
GEMM 32768x2048x32768 latency: 0.0012666528s
simulated latency: GEMM_32768x2048x32768 0.0012666528
roofline_model_simdram: total_ops=4398046511104, total_data_movement=1140850688, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.0007995391999999999, memory_bound_time=8.704e-05
GEMM roofline latency: 0.0007995391999999999ms
Results written to test_gemm_x16_base_config.json_32768_2048_32768_simdram_ddr5_operandocality.csv
Testing M=32768, K=8192, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRB  N: A  K: DS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:32768, K:8192, N:32768
Maximum Array Tile Size: {'M': 8, 'K': 1024, 'N': 2048}
get_arr_tile_stats: arr_latency=0.00037536959999999995, capacity_utilization=0.8828125
get_tile_stats: K_reduction_latency: 7.232e-05 = 947912704 / 13107200000000.0
CRB DS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
268435456 = 32768 * 8192 * 1
get_tile_io_latency: data_volume=268435456, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.048e-05 = 268435456 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 8192, 'N': 3616}, arr_tile_size: {'M': 8, 'K': 1024, 'N': 226}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.048e-05, K_N_io_latency: 0, M_N_io_latency: 9.04e-06, tile_compute_latency:0.00044768959999999996 = 0.00037536959999999995(arr_latency) + 7.232e-05(K_reduction_latency)
get_arr_tile_stats: arr_latency=2.36192e-05, capacity_utilization=0.0546875
get_tile_stats: K_reduction_latency: 4.48e-06 = 58720256 / 13107200000000.0
CRB DS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
268435456 = 32768 * 8192 * 1
get_tile_io_latency: data_volume=268435456, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=2.048e-05 = 268435456 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 8192, 'N': 224}, arr_tile_size: {'M': 8, 'K': 1024, 'N': 14}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 2.048e-05, K_N_io_latency: 0, M_N_io_latency: 5.6e-07, tile_compute_latency:2.80992e-05 = 2.36192e-05(arr_latency) + 4.48e-06(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CRB  N: A  K: DS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 32768       | 3616        | 8192        |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 8           | 226         | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.8828125   | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.0041602656           cycles|
| Total Compute Latency | 0.0040573056           cycles|
| Total Array Latency  | 0.0034019455999999993  cycles|
| Total Reduction Latency| 0.0006553599999999999  cycles|
| IO Latency           | 0.00010295999999999998 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': False, 'B': False, 'A': False, 'S': True, 'D': True}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 224                    |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 9                      |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.8828125
GEMM 32768x8192x32768 latency: 0.0041602656s
simulated latency: GEMM_32768x8192x32768 0.0041602656
roofline_model_simdram: total_ops=17592186044416, total_data_movement=1342177280, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.0031981567999999996, memory_bound_time=0.0001024
GEMM roofline latency: 0.0031981567999999996ms
Results written to test_gemm_x16_base_config.json_32768_8192_32768_simdram_ddr5_operandocality.csv
Testing M=32768, K=32768, N=32768
compute module:
simdram config: 8channels x 32ranks x 16banks x 16arrays x 1subarrays x 16384subarr_rows x 1024cols x 8devices, with_PE: True
simdram bw: 13107.2GB/s
simdram internal bw: 4739326.553672316GB/s
simdram ops: 5500.72655737705Tops
memory capacity: 1024.0GB
peripheral area: 2113.579418320765mm^2
dram area: 33792.0mm^2

memory module: N/A
io module: N/A
Running mapping search...
find_simdram_mapping: Best mapping: Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CBD  N: A  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)
Running simulation...
--- Input Matmul Size --- M:32768, K:32768, N:32768
Maximum Array Tile Size: {'M': 32, 'K': 1024, 'N': 2048}
get_arr_tile_stats: arr_latency=0.0004052352, capacity_utilization=0.953125
get_tile_stats: K_reduction_latency: 7.808e-05 = 1023410176 / 13107200000000.0
CBD RS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
1073741824 = 32768 * 32768 * 1
get_tile_io_latency: data_volume=1073741824, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=8.192e-05 = 1073741824 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 32768, 'N': 976}, arr_tile_size: {'M': 32, 'K': 1024, 'N': 61}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 8.192e-05, K_N_io_latency: 0, M_N_io_latency: 2.44e-06, tile_compute_latency:0.0004833152 = 0.0004052352(arr_latency) + 7.808e-05(K_reduction_latency)
get_arr_tile_stats: arr_latency=0.0002326784, capacity_utilization=0.546875
get_tile_stats: K_reduction_latency: 4.48e-05 = 587202560 / 13107200000000.0
CBD RS ['A'] {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
1073741824 = 32768 * 32768 * 1
get_tile_io_latency: data_volume=1073741824, dup=['A'], simd_utilization={'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
get_tile_io_latency: latency=8.192e-05 = 1073741824 / 13107200000000.0
get_tile_stats: tile_size: {'M': 32768, 'K': 32768, 'N': 560}, arr_tile_size: {'M': 32, 'K': 1024, 'N': 35}, MK_dup: 1, KN_dup:1, MN_dup:1024, M_K_io_latency: 8.192e-05, K_N_io_latency: 0, M_N_io_latency: 1.4e-06, tile_compute_latency:0.0002774784 = 0.0002326784(arr_latency) + 4.48e-05(K_reduction_latency)
================ Strategy Summary ================
Strategy(
  Loop Order: mkn  PE Enabled: True  Broadcast: AB
  Array Multicast: False
  Column Popcount: True
  Tile Mapping:  M: CBD  N: A  K: RS  Array Mapping:  R: MN  C: K
  Weight Resident: True
  Input Resident: False
  Output Resident: False
)

---------------- Tile Sizes ----------------------
| Tile_M      | Tile_N      | Tile_K      |
|-------------|-------------|-------------|
| 32768       | 976         | 32768       |

| Arr_Tile_M  | Arr_Tile_N  | Arr_Tile_K  |
|-------------|-------------|-------------|
| 32          | 61          | 1024        |

--------------- Utilization ----------------------
| Row         | Col         | Array       | Bank        | Device      | Rank        | Channel     |
|-------------|-------------|-------------|-------------|-------------|-------------|-------------|
| 0.953125    | 1.0         | 1           | 1           | 1           | 1           | 1           |

------------------ Latency -----------------------
| Total Latency        | 0.016392120000000003   cycles|
| Total Compute Latency | 0.01622688000000001    cycles|
| Total Array Latency  | 0.013605439999999998   cycles|
| Total Reduction Latency| 0.002621439999999998   cycles|
| IO Latency           | 0.00016524000000000015 cycles|

----------- Hardware Requirements ---------------
| col_multicast        | False                 |
| col_broadcast        | False                 |
| broadcast            | {'C': False, 'R': False, 'B': False, 'A': True, 'S': False, 'D': False}|
| reduction            | {'C': False, 'R': True, 'B': False, 'A': False, 'S': True, 'D': False}|
==================================================

---------------- Debug Info -----------------------
| Remaining Tiles       |                         |
|-----------------------|-------------------------|
| M_remain              | 0                      |
| N_remain              | 560                    |
| K_remain              | 0                      |

| Fully Partitioned #Tiles |                       |
|-------------------------|-----------------------|
| M_t                   | 1                      |
| N_t                   | 33                     |
| K_t                   | 1                      |

|------------------------|------------------------|
==================================================
Tiling utilization: {'C': 1, 'R': 1, 'B': 1, 'A': 1, 'S': 1, 'D': 1}
Column utilization: 1.0
Capacity utilization: 0.953125
GEMM 32768x32768x32768 latency: 0.016392120000000003s
simulated latency: GEMM_32768x32768x32768 0.016392120000000003
roofline_model_simdram: total_ops=70368744177664, total_data_movement=2147483648, peak_flops=5500726557377050.0, bandwidth=13107200000000.0
roofline_model_simdram: compute_bound_time=0.012792627199999998, memory_bound_time=0.00016384
GEMM roofline latency: 0.012792627199999998ms
Results written to test_gemm_x16_base_config.json_32768_32768_32768_simdram_ddr5_operandocality.csv
/home/siyuan/LLMCompass/exp_scripts/sensitivity/gemm_size
